<div data-ng-controller="MailingListsUpdateCtrl as ctrl">
    <div data-wizard
         data-wizard-on-cancel="resetAction"
         data-wizard-on-finish="updateMailingList"
         data-wizard-title="i18n.mailing_list_tab_modal_list_update">

        <div data-wizard-step
             data-wizard-step-valid="ctrl.updateMailingListForm.$valid">

            <p class="font-weight-bold" data-ng-bind="tr('mailing_list_tab_modal_update_list_title', ctrl.mailingList.name)"></p>

            <oui-spinner data-ng-if="ctrl.loading"></oui-spinner>

            <div data-ng-show="!ctrl.loading">
                <p data-i18n-static="mailing_list_tab_modal_update_list_heading"></p>

                <form class="form-horizontal" name="ctrl.updateMailingListForm">
                    <p>
                        <small class="text-danger">*</small>
                        <small data-i18n-static="required_fields"></small>
                    </p>

                    <div class="form-group" data-ng-class="{
                        'has-error': ctrl.updateMailingListForm.mlOwner.$dirty && ctrl.updateMailingListForm.mlOwner.$invalid,
                        'has-success': ctrl.updateMailingListForm.mlOwner.$dirty && ctrl.updateMailingListForm.mlOwner.$valid
                    }">
                        <label class="control-label col-md-4 required" for="txt-ml-owner"
                               data-i18n-static="mailing_list_tab_modal_create_list_owner"></label>
                        <div class="col-md-7">
                            <input type="email" class="form-control" id="txt-ml-owner" name="mlOwner" required
                                   data-ng-change="ctrl.emailCheck(ctrl.updateMailingListForm.mlOwner)"
                                   data-ng-model="ctrl.mailingList.ownerEmail">
                            <small class="help-block"
                                   data-i18n-static="email_tab_modal_redirection_create_email_error"
                                   data-ng-if="ctrl.updateMailingListForm.mlOwner.$dirty && ctrl.updateMailingListForm.mlOwner.$invalid"></small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-4 required" for="select-languages"
                               data-i18n-static="mailing_list_tab_modal_create_list_language"></label>
                        <div class="col-md-7">
                            <div class="oui-select oui-select_inline mb-0">
                                <select class="oui-select__input" id="select-languages" name="mlLanguage" required
                                        data-ng-model="ctrl.mailingList.language"
                                        data-ng-options="lang as tr('language_' + lang) for lang in ctrl.languages track by lang">
                                    <option value="" disabled
                                            data-i18n-static="select_placeholder"></option>
                                </select>
                                <span class="oui-icon oui-icon-chevron-down" aria-hidden="true"></span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-4"
                               data-i18n-static="mailing_list_tab_modal_create_list_reply_to"></label>
                        <div class="col-md-8">

                            <oui-radio text="{{tr('mailing_list_tab_modal_update_list_reply_to_list')}}"
                                    on-change="ctrl.selectReplyTo(ctrl.constants.MAILING_LIST)"
                                    model="ctrl.replyToSelector"
                                    name="mailing-create-answer"
                                    value="ctrl.constants.MAILING_LIST">
                            </oui-radio>

                            <oui-radio text="{{tr('mailing_list_tab_modal_update_list_reply_to_last_user')}}"
                                    on-change="ctrl.selectReplyTo(ctrl.constants.LAST_USER)"
                                    model="ctrl.replyToSelector"
                                    name="mailing-create-answer"
                                    value="ctrl.constants.LAST_USER">
                            </oui-radio>

                            <oui-radio text="{{tr('mailing_list_tab_modal_update_list_reply_to_email')}}"
                                    on-change="ctrl.selectReplyTo(ctrl.constants.REPLY_TO_EMAIL)"
                                    model="ctrl.replyToSelector"
                                    name="mailing-create-answer"
                                    value="ctrl.constants.REPLY_TO_EMAIL">
                            </oui-radio>
                        </div>
                    </div>

                    <div class="form-group" data-ng-class="{
                            'has-error': ctrl.updateMailingListForm.replyTo.$dirty && ctrl.updateMailingListForm.replyTo.$invalid,
                            'has-success': ctrl.updateMailingListForm.replyTo.$dirty && ctrl.updateMailingListForm.replyTo.$valid
                        }"
                         data-ng-if="ctrl.replyToSelector === ctrl.constants.REPLY_TO_EMAIL">
                        <label class="control-label col-md-4 required" for="txt-ml-replyTo"
                               data-i18n-static="mailing_list_tab_modal_create_list_reply_to"></label>
                        <div class="col-md-7">
                            <input type="email" class="form-control" id="txt-ml-replyTo" name="replyTo" required
                                   data-ng-change="ctrl.emailCheck(ctrl.updateMailingListForm.replyTo)"
                                   data-ng-model="ctrl.mailingList.replyTo">
                            <small class="help-block"
                                   data-i18n-static="email_tab_modal_redirection_create_email_error"
                                   data-ng-if="ctrl.updateMailingListForm.replyTo.$dirty && ctrl.updateMailingListForm.replyTo.$invalid"></small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-md-4" data-i18n-static="mailing_list_tab_modal_create_list_moderator_message"></label>
                        <div class="col-md-8">

                                <oui-radio text="{{tr('mailing_list_tab_modal_create_list_moderator_all_messages')}}"
                                        on-change="ctrl.selectModerationMsg(true)"
                                        checked="ctrl.mailingList.mlModerationMsg === true"
                                        model="ctrl.mailingList.mlModerationMsg"
                                        name="mailing-create-moderation"
                                        value="true">
                                </oui-radio>

                                <oui-radio text="{{tr('mailing_list_tab_modal_create_list_users_post_only')}}"
                                        on-change="ctrl.selectModerationMsg(false)"
                                        model="ctrl.mailingList.mlModerationMsg"
                                        name="mailing-create-moderation"
                                        value="false">
                                </oui-radio>

                                <oui-radio text="{{tr('mailing_list_tab_modal_create_list_no_moderation')}}"
                                        on-change="ctrl.selectModerationMsg(null)"
                                        model="ctrl.mailingList.mlModerationMsg"
                                        name="mailing-create-moderation"
                                        value="null">
                                </oui-radio>  
                        </div>
                    </div>

                    <div class="col-md-offset-4 pl-lg-3">
                        <oui-checkbox id="chk-ml-only-subscribers" name="mlSubscribersModeration"
                            data-model="ctrl.mailingList.options.subscribeByModerator"
                            data-text="{{::i18n.mailing_list_tab_modal_create_list_only_subscribers_moderator}}">
                        </oui-checkbox>
                        <div class="font-italic" data-ng-bind-html="tr('mailing_list_tab_create_subscribers_max', [ctrl.limits.subscribers])"></div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
